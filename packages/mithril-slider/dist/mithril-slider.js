!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("hammerjs"),require("mithril")):"function"==typeof define&&define.amd?define(["exports","hammerjs","mithril"],t):t(e["mithril-slider"]={},null,e.m)}(this,function(e,t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var r=function(e){var t=e;return function(e){if(void 0===e)return t;t=e}},i={slider:"mithril-slider",content:"mithril-slider__content",before:"mithril-slider__before",after:"mithril-slider__after"},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a={oninit:function(e){var t=e.attrs,i=r([]);t.pageData&&t.pageData().then(function(e){return y(e)});var a=parseInt(t.duration,10)||160,l=r(t.index||-1),f=void 0,d=0,u=r(t.groupBy||1),s=t.cancelDragFactor||.2,c="vertical"===t.orientation,h=t.rtl?-1:1,g=t.pageOffsetX||0,v=t.pageOffsetY||0,m=t.centerCurrent||!1,p=r(0),y=function(e){i(e),n.redraw()},C=function(e,t){return e.childNodes[t]},x=function(e,t){var n=e.style;n.transform=n["-webkit-transform"]=n["-moz-transform"]=n["-ms-transform"]=function(e){return"translate3d("+[c?"0":e+"px",c?e+"px":"0","0"].join(", ")+")"}(t)},w=function(e){f.style["-webkit-transition-duration"]=f.style["transition-duration"]=e+"ms"},E=function(r,o){r<0||r>i().length-1||(D(f),void 0!==o&&w(o),x(f,function(t){if(m&&t>=0){var n=f.children[t];if(n){if(0===p()){var r=f.parentElement;r&&p(c?r.clientHeight:r.clientWidth)}if(0!==p())return c?p()/2-n.offsetHeight/2-n.offsetTop:p()/2-n.offsetWidth/2-n.offsetLeft}e.state.rescaleRequired=!0}return-h*t*d}(r)),function(e){if(l()!==e&&(l(e),n.redraw(),t.getState)){var r=C(f,l());t.getState({index:e,hasNext:R(),hasPrevious:I(),pageEl:r})}}(r))},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=l(),n=u(),r=i().length,o=t+e*n;return o+n>r?r-n:o<0?0:o},D=function(e){var n=c?"height":"width",r=e.childNodes[0];if(r.getBoundingClientRect()[n]&&(d=r.getBoundingClientRect()[n]),t.dynamicSizePages){var o=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.childNodes)).reduce(function(e,t){return e+t.getBoundingClientRect()[n]},0);e.style[n]=o+"px"}else e.style[n]=i().length*d+"px"},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;D(f),w(e),E(b())},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return w(e),l()<i().length?E(b(1)):E(b())},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return w(e),l()>0?E(b(-1)):E(b())},R=function(){return l()+u()<i().length},I=function(){return l()>0};o(e.state,{list:i,contentEl:f,setContentEl:function(e){f=e,D(e),_()},handleDrag:function(e){var t=f,n=C(t,l()),r=c?e.deltaY+v:e.deltaX+g,i=c?n.offsetTop:-1===h?n.offsetLeft-n.parentNode.clientWidth+n.clientWidth:n.offsetLeft;x(t,r-i),e.preventDefault()},handleDragStart:function(){return D(f),w(0)},handleDragEnd:function(t){var r=function(e){var t=C(f,l()).clientWidth,n=1/(Math.abs(e)||1)*t;return n>a&&(n=a),n}(t.velocity),i=c?t.deltaY:t.deltaX;if(Math.abs(i)>d*u()*s){if(h*i<0)for(;h*i<0;)N(r),i+=h*d*u();else for(;h*i>0;)O(r),i-=h*d*u();e.state.rescaleRequired=!0,n.redraw()}else _(r)},groupBy:u,updateContentSize:D,index:l,hasNext:R,hasPrevious:I,goTo:E,goCurrent:_,goNext:N,goPrevious:O})},view:function(e){var t=e.state,r=e.attrs;r.sliderController&&r.sliderController(t),t.inited&&t.rescaleRequired&&(t.rescaleRequired=!1,t.goCurrent(),n.redraw());var o=t.index();t.groupBy(r.groupBy||1);var a=t.contentEl;return a&&t.updateContentSize(a),n("div",{class:[i.slider,r.class||""].join(" ")},[r.before?n("."+i.before,r.before):null,n("div",{class:i.content,onupdate:function(e){var n=e.dom;t.inited||n.childNodes.length>0&&(t.setContentEl(n),t.updateContentSize(n),t.touch=new function(e){var t=e.el,n=e.orientation,r=e.onStart,i=e.onMove,o=e.onEnd,a=new Hammer.Manager(t,{});return a.add(new Hammer.Pan({direction:"vertical"===n?Hammer.DIRECTION_VERTICAL:"all"===n?Hammer.DIRECTION_ALL:Hammer.DIRECTION_HORIZONTAL,threshold:0})),a.on("panstart",r),a.on("panmove",i),a.on("panend",o),{destroy:function(){a.off("panstart",r),a.off("panmove",i),a.off("panend",o)}}}({el:n,orientation:r.orientation,onStart:t.handleDragStart,onMove:t.handleDrag,onEnd:t.handleDragEnd}),t.inited=!0)},onremove:function(){return t.touch&&t.touch.destroy()}},t.list().map(function(e,t){return r.page({data:e,listIndex:t,currentIndex:o})})),r.after?n("."+i.after,r.after):null])}};e.slider=a,e.css=[{".mithril-slider":{overflow:"hidden"," .mithril-slider__content":{transitionProperty:"transform",transitionTimingFunction:"ease-out",transform:"translate3d(0, 0, 0)"}}}],Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=mithril-slider.js.map
